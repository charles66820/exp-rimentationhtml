<style media="screen">
	* {
		padding: 0px;
	}
	body {
		background-color: #eee;
	}
	div {
		background-color: #fff;
	}
	.elm-menu {
		margin: 8px;
	}
	.elm-menu:hover {
		background-color: #eee;
	}
	.elm{
		height: 100px;
		width: 100px;
		margin: 8px;
 	}
	.cmenu {
		background: #fff;
		z-index: 2300;
		display: block;
		position: absolute;
		box-shadow: 0 8px 10px 1px rgba(0,0,0,0.14), 0 3px 14px 2px rgba(0,0,0,0.12), 0 5px 5px -3px rgba(0,0,0,0.2);
		text-decoration: none;
		cursor: default;
		margin-top: -4px;
		min-height: 50px;
		min-width: 100px;
		max-height: 640px;
	}
</style>
<div id="cmenu" class="cmenu" style="display:none">
	<div class="elm-menu">default</div>
	<div class="elm-menu">menu</div>
</div>
<div id="cmenu1" class="cmenu" style="display:none">
	<div class="elm-menu">elm1</div>
	<div class="elm-menu">menu</div>
	<div class="elm-menu">contextuel</div>
</div>
<div id="cmenu2" class="cmenu" style="display:none">
	<div class="elm-menu">elm2</div>
	<div class="elm-menu">menu</div>
	<div class="elm-menu">contextuel</div>
</div>
<div id="elm1">test</div>
<div id="elm2" class="elm1 elm"></div>
<div id="elm3" class="elm2 elm"></div>
<script src="jquery-3.1.1.min.js"></script>
<script>
		window.addEventListener('contextmenu', function(m) {
			m.preventDefault();
			if (m.srcElement.classList.contains("elm1") || m.srcElement.classList.contains("elm1")){
				var menu = document.getElementById("cmenu1");
    			m.preventDefault();
    			console.log('contextmenu1');
				$("#cmenu1").show();
				$("#cmenu2").hide();
				$("#cmenu").hide();
				positionMenu(m, menu);
			}else if (m.srcElement.classList.contains("elm2") || m.srcElement.classList.contains("elm2")){
				var menu = document.getElementById("cmenu2");
				console.log('contextmenu2');
				$("#cmenu2").show();
				$("#cmenu1").hide();
				$("#cmenu").hide();
				positionMenu(m, menu);
			}else{
				var menu = document.getElementById("cmenu");
				console.log('contextmenu3');
				$("#cmenu").show();
				$("#cmenu2").hide();
				$("#cmenu1").hide();
				positionMenu(m, menu);
			}
		});
		window.addEventListener('click', function(m) {
			m.preventDefault();
			console.log('click');
			$(".cmenu").hide();
		});
function positionMenu(m, menu) {
	var clickCoords = getPosition();
  var clickCoordsX = clickCoords.x;
	var clickCoordsY = clickCoords.y;
	var menuWidth = menu.offsetWidth + 4;
  var menuHeight = menu.offsetHeight + 4;
	var windowWidth = window.innerWidth;
	var windowHeight = window.innerHeight;
	if ( (windowWidth - clickCoordsX) < menuWidth ) {
  	menu.style.left = windowWidth - menuWidth + "px";
	} else {
  	menu.style.left = clickCoordsX + "px";
	}
	if ( (windowHeight - clickCoordsY) < menuHeight ) {
  	menu.style.top = windowHeight - menuHeight + "px";
	} else {
  	menu.style.top = clickCoordsY + "px";
	}
}
function getPosition() {
	var posx = 0;
  	var posy = 0;
  	if (!e) var e = window.event;
  	if (e.pageX || e.pageY) {
		posx = e.pageX;
		posy = e.pageY;
	} else if (e.clientX || e.clientY) {
		posx = e.clientX + document.body.scrollLeft + document.documentElement.scrollLeft;
    	posy = e.clientY + document.body.scrollTop + document.documentElement.scrollTop;
	}
	return {
		x: posx,
    	y: posy
	}
}
</script>
